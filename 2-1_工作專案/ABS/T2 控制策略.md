
T2 控制策略
===
###### tags: `T2`

:::info
柏油路：乾、濕、積水、砂石樹葉、轉彎
:::
---

[TOC]

---

# 參考資料
[<font size=5, color=blue>ARTC測試方法</font>](https://www.artc.org.tw/chinese/03_service/03_02detail.aspx?pid=1942)

---

# 理論
* 地面摩擦力大時，急煞前輪鎖死，造成翻車而非打滑
* 地面摩擦力小時，急煞前輪造成鎖死，造成前輪滑動與側滑
## 摩擦路面高到低
高摩區前輪放開防止鎖死，到低摩區鎖死剎車力比高摩區低，進入低摩區會輪速會快速鎖死，需要快速反應降壓
    例：高摩擦降壓剎車力500psi時前輪不鎖死，進入低摩擦區需快速往降壓到300才不會鎖死

## 摩擦路面低到高: 
低摩區前輪未鎖死的煞車力很小，進入高摩區也不會鎖死會使車速加快需增加壓力
    例：低摩擦降壓剎車力300psi時前輪不鎖死，進入高摩擦區需快速往升壓到500才避免車速突然加快

?! 前輪不鎖死就不會打滑?  —>不按剎車在沙地會滑嗎？有速度下輪子滾動會將沙子撥開

## 相同剎車力下
低摩擦路面無法產生足夠的摩擦力，前輪鎖死速度會比高摩擦路面快

---

# 功能發想記錄：

## 如何確保前輪維持在低速滾動 取代 鎖死放開

- 確保低速滾動：調整剎車比例到目標輪速
- 如何決定何時結束動作：結束條件？
- 瓶頸：`無法精準控制油壓所以無法控制輪速`

## 打滑處理思考紀錄：

方法1. 前輪鎖死時，看tar速度與鎖死速度差值，達到門檻時強迫開啟

- 只有在特定情形有效，若tar先到0就無效
- 無法確定何時要結束，放固定時間不適合
- 此時Vest會受到前輪速影響不會下降，導致車速不準

---

::: warning 
新功能思考
:::
:::spoiler 緩升緩降壓功能：不開發減少複雜度

:::

---

:::spoiler {state="open"} 分階段研發,與顧問討論後規劃
### 第一階段~7/16：以現有開關式研發：柏油路、乾、濕、砂石、前後煞
### 第二階段：請庭豪測試：柏油路、乾、濕、積水、樹葉、泥沙、前後煞
### 第三階段：階段二功能修正
### 第四階段：請庭豪測試其他路面：乾、濕、積水、樹葉、泥沙、前後煞
:::

---
# 壓減比:   減速度/壓力

#### 讀取500psi左右的壓力，並記錄當時的減速度

##### 初始化：剎車開始歸零
##### 結束：剎車放開歸0
##### 油壓讀取頻率不變
##### 計算：壓力大於500psi時每100ms檢測一次
* 如果剎車ON並且壓力有更新時就會計算壓減比

---
# 策略

## 20210715：
修改 前輪停止更新4格後=0，前輪煞停要歸零才不會影響估測值
前輪開啟到Vest<=6kph以下才會停止

### 剎車

#### 前輪停止更新
- 監控100ms(≤4kph)確認前輪鎖死
- 車速≥6kph時，開啟到Vest<=6kph
    - 前輪速有改變就回到正常行駛判斷
- 車速<6kph就關閉
#### 前輪有更新：
- 大於等於 X kph = 高速剎車 (X 設定最大的鎖死停止速度)
    - 滑差≥A  : ABS ON (滑差=車速-前輪速/車速，前輪速越小滑差越大)
    - A>滑差≥B: 
    - **(遞減)** ABS ON → 40% → OFF
    - B>滑差  : ABS OFF
- 小於X kph = 低速剎車
    - 滑差≥C :  ABS ON
    - C>滑差≥D: 
        - **(遞減)** ABS ON —> ABS 40%
        - **(遞減)** ABS 40% or OFF —> ABS OFF
    - D>滑差:  ABS ON → 40% → OFF

### 未煞車

#### 前輪有更新: 清除倒數參數
    
#### 前輪無更新: 倒數前輪停止

---

> 未來的你一定會感謝現在努力的自己. [name=]

:::info
**Find this document incomplete?** Leave a comment!
:::


